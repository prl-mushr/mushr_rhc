jobs:
- job:
  displayName: From environment.yml
  pool:
    vmImage: 'ubuntu-16.04'
  
  variables:
    azure_tmpdir: $(Agent.TempDirectory)
    devtools: $(azure_tmpdir)/devtools
    devtools_bin: $(devtools)/bin
    test_dir: mushr_rhc_ros/test

  container: prlmushr/mushr:xenial

  steps:
  - script: git clone https://github.com/prl-mushr/devtools.git $(devtools)
    displayName: Get devtools

  - bash: echo "##vso[task.prependpath]$CONDA/bin"
    displayName: Add conda to PATH

  - script: conda env create --quiet --file $(devtools)/lint-env.yaml
    displayName: Create Anaconda environment

  - bash: |
      source activate lint
      $(devtools)/bin/mushr_lint_flake8
    displayName: flake8
